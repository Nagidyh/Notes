# Nginx

主要用来记录一些部署、使用 nginx 时遇到的问题和解决方法。

[toc]

## nginx 部署

## nginx 使用

### 伪静态

最简单的方式，在目录中写 `nginx.htaccess` 文件使用 nginx 提供的 `rewrite` 方法，来将请求头重写（自己猜的，是否是这样的实现的日后考究后再更改//TOOD）。

```nginx
if (!-e $request_filename) {
	rewrite ^.+?(/.*.php)$ $1 last;
	rewrite ^ /index.php last;
}
```
稍微记录一下这段配置使用的正则，

- `^` 匹配输入字符串的**开始位置**，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。要匹配 ^ 字符本身，请使用 `\^`。
- `.` 匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 `\.` 。
- `+` 匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 `\+`。
- `?` 匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 `\?`。
- `()` 标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 `\(` 和 `\)`。
- `/` 就是 / 本身
- `*` 匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 \*。
- `php` 字符本身
- `$` 匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 '\n' 或 '\r'。要匹配 $ 字符本身，请使用`\$`。

- `^something$` ^$的组合代表精确匹配，例如这里的`^.+?(/.*.php)$`，代表精确匹配符合其中要求的字符串。

#### rewrite ^ /index.php last;

不做多的展开，后面再仔细学习 Nginx 的具体配置和原理。

这里 `rewrite ^ /index.php last` 的意思，大意是匹配 URL 的头部，rewrite 成 /index.php，在使用部分框架时便可不必输入 index.php 也可以自动进入入口文件。

> 具体细节参考 [nginx 使用手册](http://nginx.org/en/docs/http://nginx.org/en/docs/)